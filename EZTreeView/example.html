<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.1.1.min.js"></script>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"/>

<div class="tree well">

</div>

<script>
$(function () {
    var obj = [
        {
            title: "test1",
            info: "hello",
            click: function(){console.log("test")},
            child:[
                {
                    title: "test1",
                    info: ""
                },
                {
                    title: "test1",
                    info: "hello",
                    child:[
                        {
                            title: "test1",
                            info: ""
                        },
                        {
                            title: "test1",
                            info: ""
                        }
                    ]
                },
                {
                    title: "test1",
                    info: ""
                },
            ]
        }
    ];
    addCSS();
    createViewTree($(".tree").first(), obj);
});

function createViewTree(_elem, _obj){
    addChileNode($(`<ul root="true"></ul>`).appendTo(_elem), _obj);

    $('.tree li:has(ul)').addClass('parent_li');
    $('.tree li.parent_li > button').on('click', function (e) {
        var children = $(this).parent('li.parent_li').find(' > ul > li');
        if (children.is(":visible")) {
            children.hide('fast');
            $(this).find(' > span').addClass('glyphicon-plus').removeClass('glyphicon-minus');
        } else {
            children.show('fast');  
            $(this).find(' > span').addClass('glyphicon-minus').removeClass('glyphicon-plus');
        }
        e.stopPropagation();
    });
}

function addChileNode(_elem, _obj){
	_obj.forEach(function(o){
		let _child_root = $(`<li></li>`).appendTo(_elem);
        _child_root.append(`
            <button type="button" class="btn btn-default btn-sm">
            <span class="glyphicon ${ o.child ? "glyphicon-plus" : "glyphicon-file"}"></span> ${o.title}
            </button>
            <a class="click_a" href="#">${o.info}</a>`);
        if(isFunction(o.click)){
            _child_root.find(".click_a").on("click", function(e){o.click(this);});
        }

		if(o.child){
			addChileNode($(`<ul></ul>`).appendTo(_child_root), o.child);
		}
        if(_elem.attr("root") != "true")
            _child_root.hide('fast');
	});
}

function isFunction(functionToCheck) {
   var getType = {};
   return functionToCheck && getType.toString.call(functionToCheck) === '[object Function]';
}

function addCSS(){
    $("html").append(`<style type="text/css">
        .tree {
            min-height:20px;
            padding:19px;
            margin-bottom:20px;
            background-color:#fbfbfb;
            border:1px solid #999;
            -webkit-border-radius:4px;
            -moz-border-radius:4px;
            border-radius:4px;
            -webkit-box-shadow:inset 0 1px 1px rgba(0, 0, 0, 0.05);
            -moz-box-shadow:inset 0 1px 1px rgba(0, 0, 0, 0.05);
            box-shadow:inset 0 1px 1px rgba(0, 0, 0, 0.05)
        }
        .tree li {
            list-style-type:none;
            margin:0;
            padding:10px 5px 0 5px;
            position:relative
        }
        .tree li::before, .tree li::after {
            content:'';
            left:-20px;
            position:absolute;
            right:auto
        }
        .tree li::before {
            border-left:1px solid #999;
            bottom:50px;
            height:100%;
            top:0;
            width:1px
        }
        .tree li::after {
            border-top:1px solid #999;
            height:20px;
            top:25px;
            width:25px
        }

        .tree>ul>li::before, .tree>ul>li::after {
            border:0
        }
        .tree li:last-child::before {
            height:25px
        }

    </style>`);
}
</script>
